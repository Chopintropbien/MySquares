@(idMS: Int, colors: Array[Array[Int]], nbSquaresOneEdge: Int, login: Boolean)(submitSquareForm: Form[SubmitSquare])(implicit message: RequestHeader)

<input type="hidden" id="selectedSquareJson" value="">
@css = {
<!-- For this page-->
<link href="@routes.Assets.versioned("stylesheets/haveSquares.css")" rel="stylesheet">
}

@js(idMS: Int, colors: Array[Array[Int]], nbSquaresOneEdge: Int) = {
<!-- select the month in the sidebar -->
<!--<script src="@routes.Assets.versioned("javascripts/haveSquares/sidebar-select-date.js")"> </script>-->

<!--<script> selectMonth(@idMS); </script>-->

<!--Step selection -->
<script src="@routes.Assets.versioned("javascripts/haveSquares/sept-selection.js")"> </script>

<!-- Selection of the square-->
<script src="@routes.Assets.versioned("javascripts/drawCheck.js")"></script>
<script src="@routes.Assets.versioned("javascripts/select-squares.js")"></script>
<script src="@routes.Assets.versioned("javascripts/square-canvas.js")"></script>

<!-- First Step: Set the MySquare where we selection the square we want -->
<script>
    // common for the 2 canvas

    // array of colors and free squares
    var jsColors = [@colors.map(array => "[" + array.mkString(",") + "]").mkString(",")];
    var selectedSquare = [@colors.map( array  => "false,") false]; // TODO: enlever le dernier false

    var coloredSquare = document.getElementById("coloredSquare");
    var canvasWidth = coloredSquare.clientWidth;

    // use for compute and draw the little squares
    var nbSquaresOneEdge = @nbSquaresOneEdge;
    var littleSL = canvasWidth / nbSquaresOneEdge;


    // draw the square
    drawSquares(jsColors, nbSquaresOneEdge, coloredSquare, canvasWidth);

    // add event for select the squares

    // canvas where we will draw the selected squares and event
    var canvasToDraw = document.getElementById("selectedSquare");
    canvasToDraw.width = canvasWidth;
    canvasToDraw.height = canvasWidth;
    var contextToDraw = canvasToDraw.getContext('2d');

    // add event to the canvas to draw
    selectSquares(canvasToDraw);

</script>


<!--Second step: Draw into the square -->
<script>
    // set the square height
    var squareWeDraw = $("#square-where-we-draw");
    var width = squareWeDraw.width();
    squareWeDraw.height(width).width(width);
    squareWeDraw.attr("height", width).attr("width", width);
    $("#draw-square").hide();

    // set the textArea height
    var textArea = $("#writeTextTextArea")
    textArea.height(textArea.width());
</script>
<!--able to draw text and change color-->
<script src="@routes.Assets.versioned("javascripts/haveSquares/writeTextInCanvas.js")"> </script>

<!--deal with the color selection in the palette-->
<script src="@routes.Assets.versioned("javascripts/haveSquares/select-color.js")"> </script>





<!--Third step: Confirm you square, login, share-->

<script>
    var purchaseButton = $("#purchaseSquares");
    var previewSquare = $("#previewSquare");

    purchaseButton.click(function(){

        goToStep3();

        var width = previewSquare.width();
        previewSquare.height(width).width(width);
        previewSquare.attr("height", width).attr("width", width);

        var dataURL = squareWeDraw.get(0).toDataURL();
        var ctx = previewSquare.get(0).getContext("2d");

        var image = new Image();
        image.onload = function() {
            ctx.drawImage(image, 0, 0, width, width);
        };
        image.src = dataURL;
    });
</script>

<!-- deal with the display of the register and login form-->
<script src="@routes.Assets.versioned("javascripts/haveSquares/display-login-register.js")"></script>
<script src="@routes.Assets.versioned("javascripts/loginRegisterContact/formValidation.js")"></script>
<script src="@routes.Assets.versioned("javascripts/loginRegisterContact/loginFormValidation.js")"></script>
<script src="@routes.Assets.versioned("javascripts/loginRegisterContact/registerFormValidation.js")"></script>
}


@commonToAllPage.template(css, sidebar(idMS)(message), mainBarColumn(submitSquareForm)(message), js(idMS, colors, nbSquaresOneEdge), login)