@import models.Square._

@(square: Square, idxSquaresUser: Seq[Int], login: Boolean)(implicit flash: Flash)
<!--TODO: Comprendre pk ca ma charche pas comme ça =>  jsSquares-->

@css = {
    <!-- For this page-->
    <link href="@routes.Assets.versioned("stylesheets/home.css")" rel="stylesheet">
}

@js(square: Square) = {

<script src="@routes.Assets.versioned("javascripts/drawMS/coords-in-canvas.js")"></script>
<script src="@routes.Assets.versioned("javascripts/drawMS/draw-ms.js")"></script>
<script src="@routes.Assets.versioned("javascripts/drawMS/highlight-square.js")"></script>





<!--Set the Square-->
<script>
    var square = document.getElementById("square");
    var canvasWidth = square.clientWidth;


    //TODO: Comprendre pk ca ma charche pas comme ça
    //var jsSquares = [square.squares.map(t =>"\"" + t._1 + "\"").mkString(",")];

    var squaresString = "@square.squares.map(t =>t._1).mkString("specialBase64")";
    var jsSquares = squaresString.split("specialBase64");

    // use for compute and draw the little squares
    var nbSquaresOneEdge = @square.nbSquaresOneEdge;
    var littleSL = canvasWidth / nbSquaresOneEdge;


    // draw the square
    square.width = canvasWidth;
    square.height = canvasWidth;
    drawSquares(jsSquares, nbSquaresOneEdge, square, canvasWidth);

    // add event to the canvas to draw


    // canvas where we will draw the selected squares and event
    var canvasToDraw = $("#highlightSquare");
    var width = canvasWidth;
    canvasToDraw.height(width).width(width);
    canvasToDraw.attr("height", width).attr("width", width);


    var idxSquares = [@idxSquaresUser.mkString(",")];

    highlightSquares(canvasToDraw.get(0), idxSquares, nbSquaresOneEdge, littleSL);

</script>


<!--Set the square previus-->
<script src="@routes.Assets.versioned("javascripts/home/showPreviewSquare.js")"></script>
<script>
    var previewSquare = $("#previewSquare");
    var width = previewSquare.width();
    previewSquare.height(width).width(width);
    previewSquare.attr("height", width).attr("width", width);

    showPreviewSquare(canvasToDraw.get(0), previewSquare.get(0), jsSquares, @square.nbSquaresOneEdge);
</script>


<!--Set the legend for the square that the user owned-->
<script>
    var highlightEx = $("#highlightYourSquareEx");
    var widthH = highlightEx.width();
    highlightEx.height(widthH).width(widthH);
    highlightEx.attr("height", widthH).attr("width", widthH);

    var widthEx = Math.min(littleSL, widthH);

    highlight(1, 1, widthEx, highlightEx.get(0).getContext('2d'));

</script>


}

@commonToAllPage.template(css, sidebar(), mainBarColumn(flash), js(square), login)